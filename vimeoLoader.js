
(function(p,k){p.MVPVimeoLoader=function(q){function r(a){k.ajax({type:"GET",url:t+"includes/vimeo/vimeo_data.php",data:{type:"next_page",path:a,vai:u},dataType:"json"}).done(function(b){v(b)}).fail(function(b,h,l){console.log(b,h,l)})}function v(a){g=a.body.paging&&a.body.paging.next?a.body.paging.next:null;var b;var h=a.body.data?a.body.data.length:1;for(b=0;b<h&&e.length!=d;b++){var l=a.body.uri?a.body:a.body.data[b];e.push(w(l))}e.length<d?g?(e.length+f>d&&(f=d-e.length,a=g.split("per_page=")[1].split("&")[0],
g=g.replace("per_page="+a,"per_page="+f)),r(g)):k(m).trigger("MVPVimeoLoader.END_LOAD",{data:e,nextPageToken:g}):k(m).trigger("MVPVimeoLoader.END_LOAD",{data:e,nextPageToken:g})}function w(a){var b=k.extend(!0,{},c);b.deeplink&&"vimeo_single"!=b.origtype&&(b.deeplink+=(n+1).toString(),n++);b.type="vimeo";-1<a.uri.indexOf(":")&&(a.uri=a.uri.substr(0,a.uri.lastIndexOf(":")));b.path=a.uri.substr(a.uri.lastIndexOf("/")+1);a.duration&&(b.duration=a.duration);!b.title&&a.name&&(b.title=a.name);!b.description&&
a.description&&(b.description=a.description);!b.thumb&&a.pictures&&(b.pictures=a.pictures);b.url||(b.url="https://vimeo.com/"+b.path);a.release_time&&(b.release_time=a.release_time);a.download&&(a.download.link?b.download=a.download.link:a.download[0]&&(b.download=a.download[0].link));a.user&&a.user.account&&(b.userAccount=a.user.account);return b}var m=this,t=q.sourcePath,d,f=100,g,c=[],e=[],n,u=q.vai;this.resumeLoad=function(a){e=[];a?r(a):k(m).trigger("MVPVimeoLoader.END_LOAD",{data:e,nextPageToken:a})};
this.setDataFromCache=function(a){e=[];c=a;f=100;d=c.limit||1E3;d<f&&(f=d)};this.setData=function(a){if("file:"==p.location.protocol)console.log("Using Vimeo locally is not possible! This requires server connection!");else{e=[];c=a;f=100;d=c.limit||1E3;d<f&&(f=d);n=0;g=null;"vimeo_single"==c.type&&-1<c.path.indexOf("/")&&(c.path=c.path.replace("/",":"));var b=t+"includes/vimeo/vimeo_data.php";a={type:c.type,path:c.path,user_id:c.user_id,sort:c.sort,sortDirection:c.sortDirection,page:1,perPage:d<f?
d:f,vai:u};k.ajax({type:"GET",url:b,data:a,dataType:"json"}).done(function(h){if(!h.body)return console.log("Vimeo response null!"),!1;v(h)}).fail(function(h,l,x){console.log(h,l,x)})}};this.getNextPageToken=function(){return g}}})(window,jQuery);